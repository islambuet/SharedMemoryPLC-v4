const {Controller, ControllerManager} = require('./src/index.js')

const cm = new ControllerManager();

//addController(ipAddress, slot = 0, rpi = 100, connected = true, retrySP = 3000, opts = {})
const cont = cm.addController('192.168.121.10');

cont.connect();

//addTag(tagname, program = null, arrayDims = 0, arraySize = 0x01)
let tag1

cont.on('TagChanged', (tag, prevValue) => {
  console.log(tag.name, ' changed from ', prevValue, ' => ', tag.value)
})



cont.on('Connected', () => {
    tag1 = cont.addTag('UDTX')
    console.log(tag1._template)
    
    setInterval(()=> {
        

        tag1.value.bol11 = tag1.value.bol11 ? false : true;
    }, 1000)

    setInterval(() => {
        tag1.value.int1 = tag1.value.int1 + 1
    }, 100)
})

cont.on('error', (e) => {
  console.log(e)
})